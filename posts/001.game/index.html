<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title >我的部落格</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1 id="title">我的部落格</h1>
    <nav>
      <a href="#gallery">作品展示</a>
      <a href="#blog">文章</a>
      <a href="#contact">聯絡</a>
    </nav>
  </header>
  
  <section id="blog">
    <h2>最新文章</h2>
    <ul id="blog-list">
      <!-- JavaScript 會動態插入文章連結 -->
    </ul>
  </section>

  <section id="contact">
    <h2>聯絡我</h2>
    <p>如果你有任何問題或合作提案，歡迎透過以下方式聯絡我：</p>
    <ul>
      <li>Email: <a href="mailto:baiyanchen8@gamil.com">baiyanchen8@gamil.com</a></li>
      <li>GitHub: <a href="https://github.com/baiyanchen8" target="_blank">baiyanchen8</a></li>
      <li>HackMD: <a href="https://hackmd.io/@baiyanchen8" target="_blank">baiyanchen8 的 HackMD</a></li>
    </ul>
  </section>

  <footer> <p><a href="/index.html">回首頁</a></p></footer>
  <script>


    function loadPosts(data) {
      const blogList = document.getElementById('blog-list');
      const sortedThemes=Object.keys(data.posts).sort();
        sortedThemes.forEach(theme => {
        const themePosts = data.posts[theme];
      const indexPost = themePosts.find(post => post.title.toLowerCase() === 'index');
        // const url = window.location.href;
       // const  theme1=    url.split('/').pop() || '我的部落格';
        //  theme1 = theme1.replace(/^\d+\./, '').replace(/\.html$/, ''); // 去掉编号和后缀
          // 建立文章清單
          const postList = document.createElement('ul');
          data.posts[theme]
          .filter(post => post.title.toLowerCase() !== 'index') // 排除 index.html
          .forEach(post => {
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.classList.add('a1');
            a.href = post.path;   
            a.textContent = post.title;

            const updatedTimeElement = document.createElement('div');
            updatedTimeElement.classList.add('updated-time');
            updatedTimeElement.textContent = `最後更新時間: ${post.updated_at}`;

            li.appendChild(a);
            li.appendChild(updatedTimeElement);
            postList.appendChild(li);
          });

          blogList.appendChild(postList);
      });
    }

    fetch('/asserts/file-list.json')
      .then(response => {
        if (!response.ok) {
          throw new Error('無法載入 JSON 數據');
        }
        return response.json();
      })
      .then(data => {
        console.log(data);
        loadPosts(data);
      })
      .catch(error => {
        console.error('錯誤：', error);
        alert('無法載入數據，請稍後再試。');
      });

    // 动态设置页面标题
    const url = window.location.href;
    console.log(url);
    const themename = url.split('/').pop() || '我的部落格';

    const prettyName = themename.replace(/^\d+\./, '').replace(/\.html$/, ''); // 去掉编号和后缀
    console.log(prettyName);
    // 设置页面标题
    document.getElementById('title').innerText = prettyName;    
  </script>
</body>
</html>